import{r as e}from"./vendor-CpqJgtbW.js";import{C as t,A as s,U as i,F as a,X as r,M as n,E as l,a as o,D as c,B as d,W as m,b as h,S as u,c as x,P as p,d as g,e as f,f as y,R as b,V as w,g as v,h as j,i as N,I as k,j as C,k as S,l as F,m as M,n as T,o as A,L as $}from"./ui-DQne-7Ya.js";var R={exports:{}},D={},E=e,z=Symbol.for("react.element"),P=Symbol.for("react.fragment"),B=Object.prototype.hasOwnProperty,I=E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,s){var i,a={},r=null,n=null;for(i in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(n=t.ref),t)B.call(t,i)&&!L.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:z,type:e,key:r,ref:n,props:a,_owner:I.current}}D.Fragment=P,D.jsx=O,D.jsxs=O,R.exports=D;var U=R.exports,V=(e=>(e.INITIALIZATION="initialization",e.AUDIO_PROCESSING="audio_processing",e.ANALYSIS="analysis",e.VISUALIZATION="visualization",e.FILE_OPERATIONS="file_operations",e.USER_INTERACTION="user_interaction",e.NETWORK="network",e.MEMORY="memory",e.RENDERING="rendering",e))(V||{});const H=new class{metrics=[];alerts=[];memorysamples=[];thresholds={"file.upload":2e3,"audio.decode":5e3,"analysis.total":3e4,"analysis.spectral":3e3,"analysis.tempo":5e3,"analysis.key":4e3,"analysis.mfcc":2e3,"visualization.render":500,"export.generate":3e3,"ui.response":100};maxMetrics=1e3;memoryMonitorInterval=null;constructor(){this.startMemoryMonitoring(),this.setupPerformanceObserver()}setupPerformanceObserver(){try{if("PerformanceObserver"in window){new PerformanceObserver(e=>{for(const t of e.getEntries())this.recordSystemMetric(t.name,t.startTime,{entryType:t.entryType,duration:t.duration})}).observe({entryTypes:["paint"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.recordSystemMetric("largest-contentful-paint",t.startTime,{size:t.size,element:t.element?.tagName})}).observe({entryTypes:["largest-contentful-paint"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.recordSystemMetric("cumulative-layout-shift",performance.now(),{value:t.value,hadRecentInput:t.hadRecentInput})}).observe({entryTypes:["layout-shift"]})}}catch(e){}}startMemoryMonitoring(){this.memoryMonitorInterval=window.setInterval(()=>{const e=this.getCurrentMemoryUsage();e>0&&(this.memorysamples.push({timestamp:Date.now(),usage:e}),this.memorysamples.length>100&&(this.memorysamples=this.memorysamples.slice(-100)),this.checkMemoryAlerts(e))},1e3)}getCurrentMemoryUsage(){return"undefined"!=typeof performance&&performance.memory?performance.memory.usedJSHeapSize:0}checkMemoryAlerts(e){const t=52428800,s=104857600;e>s?this.createAlert("memory-usage",s,e,"critical","Critical memory usage detected. Consider refreshing the page or using smaller files."):e>t&&this.createAlert("memory-usage",t,e,"warning","High memory usage detected. Close other tabs or use smaller files for better performance.")}createAlert(e,t,s,i,a){const r={id:`alert-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,metric:e,threshold:t,actualValue:s,severity:i,suggestion:a};this.alerts.push(r),this.alerts.length>50&&(this.alerts=this.alerts.slice(-50))}recordSystemMetric(e,t,s){const i={id:`system-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e,startTime:t,endTime:performance.now(),duration:performance.now()-t,metadata:s,tags:["system"],category:"rendering"};this.metrics.push(i),this.trimMetrics()}startTiming(e,t,s,i){const a=`metric-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r={id:a,name:e,startTime:performance.now(),metadata:s,tags:i||[],category:t};return this.metrics.push(r),this.trimMetrics(),a}endTiming(e,t){const s=this.metrics.find(t=>t.id===e);if(!s)return null;const i=performance.now();return s.endTime=i,s.duration=i-s.startTime,t&&(s.metadata={...s.metadata,...t}),this.checkPerformanceAlerts(s),s}checkPerformanceAlerts(e){if(!e.duration)return;const t=this.thresholds[e.name];if(t&&e.duration>t){const s=e.duration>2*t?"critical":"warning",i=this.getPerformanceSuggestion(e.name,e.duration);this.createAlert(e.name,t,e.duration,s,i)}}getPerformanceSuggestion(e,t){return{"file.upload":"Try using smaller audio files or check your internet connection.","audio.decode":"The audio file may be large or in a complex format. Try using WAV or MP3.","analysis.total":"Consider using shorter audio clips or try on a device with more processing power.","analysis.spectral":"Spectral analysis is taking longer than expected. Try reducing analysis complexity.","analysis.tempo":"Tempo detection is slow. This may be due to complex rhythm patterns.","analysis.key":"Key detection is taking longer than expected. Try with harmonic audio content.","analysis.mfcc":"MFCC extraction is slow. This may be due to high sample rate audio.","visualization.render":"Visualization rendering is slow. Try reducing the visualization complexity.","export.generate":"Export is taking longer than expected. Try exporting smaller datasets.","ui.response":"UI responsiveness is degraded. Close other applications and browser tabs."}[e]||"Performance is slower than expected. Try refreshing the page or using a more powerful device."}recordInstantMetric(e,t,s,i,a){const r={id:`instant-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e,startTime:performance.now(),endTime:performance.now(),duration:t,metadata:i,tags:a||[],category:s};this.metrics.push(r),this.trimMetrics()}timeFunction(e,t,s,i){const a=this.startTiming(t,s,i);try{const t=e();return t instanceof Promise?t.finally(()=>{this.endTiming(a)}):(this.endTiming(a),t)}catch(r){throw this.endTiming(a,{error:r instanceof Error?r.message:"Unknown error"}),r}}trimMetrics(){this.metrics.length>this.maxMetrics&&(this.metrics=this.metrics.slice(-this.maxMetrics))}getMetrics(){return[...this.metrics]}getMetricsByCategory(e){return this.metrics.filter(t=>t.category===e)}getMetricsByName(e){return this.metrics.filter(t=>t.name===e)}getAverageByName(e){const t=this.getMetricsByName(e).filter(e=>void 0!==e.duration);if(0===t.length)return 0;return t.reduce((e,t)=>e+(t.duration||0),0)/t.length}getReport(){const e=this.metrics.filter(e=>void 0!==e.duration),t={totalMetrics:e.length,averageDuration:e.length>0?e.reduce((e,t)=>e+(t.duration||0),0)/e.length:0,slowestOperation:e.reduce((e,t)=>!e||(t.duration||0)>(e.duration||0)?t:e,null),fastestOperation:e.reduce((e,t)=>!e||(t.duration||0)<(e.duration||0)?t:e,null),alerts:[...this.alerts]},s=Object.values(V).reduce((e,t)=>{const s=this.getMetricsByCategory(t).filter(e=>void 0!==e.duration),i=s.reduce((e,t)=>e+(t.duration||0),0);return e[t]={count:s.length,averageDuration:s.length>0?i/s.length:0,totalDuration:i,metrics:s},e},{}),i={current:this.getCurrentMemoryUsage(),peak:Math.max(...this.memorysamples.map(e=>e.usage),0),samples:[...this.memorysamples]},a=this.getMetricsByName("first-contentful-paint"),r=this.getMetricsByName("largest-contentful-paint");return{summary:t,byCategory:s,memoryUsage:i,firstContentfulPaint:a.length>0?a[0].startTime:void 0,largestContentfulPaint:r.length>0?r[0].startTime:void 0}}getAlerts(){return[...this.alerts]}clearAlerts(){this.alerts=[]}clearMetrics(){this.metrics=[],this.memorysamples=[]}setThreshold(e,t){this.thresholds[e]=t}getThreshold(e){return this.thresholds[e]}exportData(){const e={metrics:this.metrics,alerts:this.alerts,memorysamples:this.memorysamples,thresholds:this.thresholds,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href};return JSON.stringify(e,null,2)}destroy(){this.memoryMonitorInterval&&(clearInterval(this.memoryMonitorInterval),this.memoryMonitorInterval=null),this.clearMetrics(),this.clearAlerts()}};function W({onFileSelect:n,isProcessing:l,engineReady:o}){const[c,d]=e.useState(!1),[m,h]=e.useState(null),[u,x]=e.useState(null),p=e.useRef(null),g=e.useCallback(e=>{const t=[];return["audio/mpeg","audio/mp3","audio/wav","audio/wave","audio/flac","audio/x-flac","audio/aiff","audio/x-aiff","audio/ogg","audio/webm","audio/mp4","audio/aac"].includes(e.type)||e.name.match(/\.(mp3|wav|flac|aiff|ogg|webm|mp4|aac)$/i)?e.size>104857600?{isValid:!1,error:`File too large: ${(e.size/1024/1024).toFixed(1)}MB. Maximum size is 100MB.`}:(e.size>52428800&&t.push("Large file detected. Analysis may take longer."),e.name.includes(" ")&&t.push("Filename contains spaces. Consider using underscores."),(e.type.includes("compressed")||e.name.toLowerCase().includes("mp3"))&&t.push("Compressed audio detected. Lossless formats (WAV, FLAC) provide better analysis accuracy."),{isValid:!0,warnings:t.length>0?t:void 0}):{isValid:!1,error:`Unsupported file type: ${e.type||"Unknown"}. Please use MP3, WAV, FLAC, AIFF, OGG, WebM, MP4, or AAC.`}},[]),f=e.useCallback(e=>{const t=g(e);x(t),h(e),t.isValid&&n(e)},[g,n]),y=e.useCallback(e=>{if(e.preventDefault(),d(!1),!o||l)return;const t=Array.from(e.dataTransfer.files);t.length>0&&f(t[0])},[o,l,f]),b=e.useCallback(e=>{e.preventDefault(),o&&!l&&d(!0)},[o,l]),w=e.useCallback(e=>{e.preventDefault(),d(!1)},[]),v=e.useCallback(e=>{const t=e.target.files;t&&t.length>0&&f(t[0])},[f]),j=e.useCallback(()=>{h(null),x(null),p.current&&(p.current.value="")},[]);return U.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[U.jsxs("div",{style:(()=>{const e={borderWidth:"2px",borderStyle:"dashed",borderRadius:"16px",padding:"48px 32px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",background:"var(--studio-bg-tertiary)",borderColor:"var(--studio-border)"};return o?l?{...e,cursor:"not-allowed",borderColor:"var(--studio-accent-blue)",boxShadow:"0 0 20px rgba(74, 158, 255, 0.2)"}:c?{...e,transform:"scale(1.02)",borderColor:"var(--studio-accent-gold)",background:"var(--studio-bg-elevated)",boxShadow:"var(--studio-shadow-glow)"}:m&&u?.isValid?{...e,borderColor:"var(--studio-success)",background:"rgba(16, 185, 129, 0.05)"}:u&&!u.isValid?{...e,borderColor:"var(--studio-error)",background:"rgba(239, 68, 68, 0.05)"}:e:{...e,opacity:.5,cursor:"not-allowed"}})(),onDrop:y,onDragOver:b,onDragLeave:w,onClick:()=>o&&!l&&p.current?.click(),children:[U.jsxs("div",{style:{textAlign:"center"},children:[U.jsx("div",{style:{marginBottom:"24px"},children:l?U.jsx("div",{className:"studio-pulse",style:{width:"64px",height:"64px",margin:"0 auto"},children:U.jsx("div",{style:{width:"64px",height:"64px",border:"4px solid var(--studio-accent-blue)",borderTop:"4px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):m&&u?.isValid?U.jsx(t,{className:"studio-glow",style:{width:"64px",height:"64px",color:"var(--studio-success)",margin:"0 auto"}}):u&&!u.isValid?U.jsx(s,{style:{width:"64px",height:"64px",color:"var(--studio-error)",margin:"0 auto"}}):U.jsx(i,{style:{width:"64px",height:"64px",color:"var(--studio-accent-gold)",margin:"0 auto",opacity:.7}})}),U.jsx("p",{className:"studio-header",style:{fontSize:"20px",marginBottom:"8px"},children:o?l?"üî¨ Analysis in progress...":m&&u?.isValid?"‚úÖ File ready for analysis":u&&!u.isValid?"‚ùå File validation failed":"üéµ Drop audio files or click to browse":"‚è≥ Waiting for analysis engine..."}),U.jsx("p",{className:"studio-subheader",style:{fontSize:"13px",marginTop:"8px"},children:o?l?"Please wait for current analysis to complete":"Supports MP3, WAV, FLAC, AIFF, OGG, WebM, MP4, AAC up to 100MB":"Engine initialization required"})]}),U.jsx("input",{ref:p,type:"file",accept:"audio/*,.mp3,.wav,.flac,.aiff,.ogg,.webm,.mp4,.aac",onChange:v,style:{display:"none"},disabled:!o||l})]}),m&&U.jsxs("div",{className:"studio-card",style:{padding:"20px"},children:[U.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[U.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[U.jsx(a,{style:{width:"20px",height:"20px",flexShrink:0,color:"var(--studio-accent-blue)"}}),U.jsxs("div",{style:{minWidth:0,flex:1},children:[U.jsx("p",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--studio-text-primary)"},children:m.name}),U.jsxs("p",{style:{fontSize:"13px",color:"var(--studio-text-tertiary)",marginTop:"4px"},children:[(N=m.size,N<1024?`${N} B`:N<1048576?`${(N/1024).toFixed(1)} KB`:`${(N/1024/1024).toFixed(1)} MB`)," ‚Ä¢ ",m.type||"Unknown type"]})]})]}),U.jsx("button",{onClick:j,disabled:l,style:{padding:"8px",borderRadius:"8px",border:"none",background:"transparent",color:"var(--studio-text-secondary)",cursor:l?"not-allowed":"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{l||(e.currentTarget.style.background="rgba(239, 68, 68, 0.2)",e.currentTarget.style.color="var(--studio-error)")},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="var(--studio-text-secondary)"},children:U.jsx(r,{style:{width:"16px",height:"16px"}})})]}),u&&U.jsxs("div",{style:{marginTop:"16px",display:"flex",flexDirection:"column",gap:"8px"},children:[!u.isValid&&u.error&&U.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",color:"var(--studio-error)"},children:[U.jsx(s,{style:{width:"16px",height:"16px",flexShrink:0}}),U.jsx("span",{children:u.error})]}),u.warnings&&u.warnings.map((e,t)=>U.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",color:"var(--studio-warning)"},children:[U.jsx(s,{style:{width:"16px",height:"16px",flexShrink:0}}),U.jsx("span",{children:e})]},t))]})]}),U.jsx("div",{className:"studio-card",style:{padding:"20px"},children:U.jsxs("div",{className:"studio-grid studio-grid-3",style:{gap:"24px",textAlign:"center"},children:[U.jsxs("div",{className:"studio-metric",children:[U.jsx("div",{className:"studio-metric-label",children:"Max Size"}),U.jsx("div",{className:"studio-metric-value",style:{fontSize:"20px"},children:"100MB"})]}),U.jsxs("div",{className:"studio-metric",children:[U.jsx("div",{className:"studio-metric-label",children:"Formats"}),U.jsx("div",{className:"studio-metric-value",style:{fontSize:"20px"},children:"8 Types"})]}),U.jsxs("div",{className:"studio-metric",children:[U.jsx("div",{className:"studio-metric-label",children:"Quality"}),U.jsx("div",{className:"studio-metric-value",style:{fontSize:"20px"},children:"Any SR"})]})]})})]});var N}function _({analysisData:t,isAnalyzing:s}){const[i,a]=e.useState("spectral"),[r,u]=e.useState(!0),[x,p]=e.useState(!0),[g,f]=e.useState(!1),y=e.useRef(null),b=[{id:"spectral",name:"Spectral",icon:U.jsx(d,{className:"w-4 h-4"}),description:"Frequency domain analysis"},{id:"mfcc",name:"MFCC",icon:U.jsx(m,{className:"w-4 h-4"}),description:"Mel-frequency cepstral coefficients"},{id:"tempo",name:"Tempo",icon:U.jsx(h,{className:"w-4 h-4"}),description:"Rhythm and beat analysis"},{id:"key",name:"Key",icon:U.jsx(n,{className:"w-4 h-4"}),description:"Musical key detection"}];if(s)return U.jsx("div",{className:"glassmorphic-card p-8",children:U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"w-16 h-16 mx-auto mb-4",children:U.jsx("div",{className:"w-16 h-16 border-4 border-blue-400 border-t-transparent rounded-full animate-spin"})}),U.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Analyzing Audio"}),U.jsx("p",{className:"text-white/60",children:"Extracting features and generating insights..."})]})});if(!t)return U.jsx("div",{className:"glassmorphic-card p-8",children:U.jsxs("div",{className:"text-center text-white/60",children:[U.jsx(n,{className:"w-16 h-16 mx-auto mb-4 text-white/40"}),U.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Analysis Data"}),U.jsx("p",{children:"Upload and analyze an audio file to see results here."})]})});const w=(()=>{if(!t)return null;const e=[];if(t.tempo?.bpm&&e.push({label:"Tempo",value:`${t.tempo.bpm} BPM`,color:"text-blue-400"}),t.key?.key&&e.push({label:"Key",value:t.key.key,color:"text-green-400"}),t.spectral?.centroid?.mean&&e.push({label:"Brightness",value:`${(t.spectral.centroid.mean/1e3).toFixed(1)}k Hz`,color:"text-yellow-400"}),t.duration){const s=Math.floor(t.duration/60),i=Math.floor(t.duration%60);e.push({label:"Duration",value:`${s}:${i.toString().padStart(2,"0")}`,color:"text-purple-400"})}return e})();return U.jsxs("div",{className:"space-y-6",children:[w&&w.length>0&&U.jsxs("div",{className:"glassmorphic-card p-6",children:[U.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Analysis Overview"}),U.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:w.map((e,t)=>U.jsxs("div",{className:"text-center",children:[U.jsx("div",{className:"text-white/60 text-sm mb-1",children:e.label}),U.jsx("div",{className:`font-semibold text-lg ${e.color}`,children:e.value})]},t))})]}),U.jsx("div",{className:"glassmorphic-card p-6",children:U.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[U.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(e=>U.jsxs("button",{onClick:()=>a(e.id),className:"glassmorphic-button px-4 py-2 flex items-center space-x-2 transition-all "+(i===e.id?"bg-blue-500/20 border-blue-400/50 text-blue-300":"hover:bg-white/5"),title:e.description,children:[e.icon,U.jsx("span",{className:"font-medium",children:e.name})]},e.id))}),U.jsxs("div",{className:"flex items-center space-x-4",children:[U.jsx("button",{onClick:()=>u(!r),className:"glassmorphic-button p-2 transition-colors "+(r?"text-green-400":"text-white/60"),title:"Toggle grid",children:r?U.jsx(l,{className:"w-4 h-4"}):U.jsx(o,{className:"w-4 h-4"})}),U.jsx("button",{onClick:()=>p(!x),className:"glassmorphic-button p-2 transition-colors "+(x?"text-green-400":"text-white/60"),title:"Toggle labels",children:U.jsx("span",{className:"text-sm font-medium",children:"Aa"})}),U.jsx("button",{onClick:()=>{if(!y.current)return;const e=document.createElement("a");e.download=`harmonix-${i}-analysis.png`,e.href=y.current.toDataURL(),e.click()},className:"glassmorphic-button p-2 hover:bg-blue-500/20 transition-colors",title:"Export visualization",children:U.jsx(c,{className:"w-4 h-4"})})]})]})}),U.jsxs("div",{className:"glassmorphic-card p-6",children:[U.jsxs("div",{className:"mb-4",children:[U.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center space-x-2",children:[b.find(e=>e.id===i)?.icon,U.jsxs("span",{children:[b.find(e=>e.id===i)?.name," Analysis"]})]}),U.jsx("p",{className:"text-white/60 text-sm",children:b.find(e=>e.id===i)?.description})]}),U.jsx("div",{className:"bg-black/20 rounded-lg p-4 overflow-hidden",children:U.jsx("canvas",{ref:y,className:"w-full h-96 max-w-full",style:{imageRendering:"pixelated"}})}),U.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:["spectral"===i&&t.spectral&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Spectral Centroid"}),U.jsxs("div",{className:"text-white font-medium",children:[t.spectral.centroid?.mean?.toFixed(1)||"N/A"," Hz"]})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Spectral Rolloff"}),U.jsxs("div",{className:"text-white font-medium",children:[t.spectral.rolloff?.mean?.toFixed(1)||"N/A"," Hz"]})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Brightness"}),U.jsxs("div",{className:"text-white font-medium",children:[(100*(t.spectral.brightness?.mean||0)).toFixed(1),"%"]})]})]}),"tempo"===i&&t.tempo&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"BPM"}),U.jsx("div",{className:"text-white font-medium",children:t.tempo.bpm})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Confidence"}),U.jsxs("div",{className:"text-white font-medium",children:[(100*(t.tempo.confidence||0)).toFixed(1),"%"]})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Beats Detected"}),U.jsx("div",{className:"text-white font-medium",children:t.tempo.beats?.length||0})]})]}),"key"===i&&t.key&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Detected Key"}),U.jsx("div",{className:"text-white font-medium",children:t.key.key||"Unknown"})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Scale"}),U.jsx("div",{className:"text-white font-medium",children:t.key.scale||"Unknown"})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Confidence"}),U.jsxs("div",{className:"text-white font-medium",children:[(100*(t.key.confidence||0)).toFixed(1),"%"]})]})]}),"mfcc"===i&&t.mfcc&&U.jsxs(U.Fragment,{children:[U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Coefficients"}),U.jsx("div",{className:"text-white font-medium",children:t.mfcc.length})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Range"}),U.jsxs("div",{className:"text-white font-medium",children:[Math.min(...t.mfcc).toFixed(2)," to ",Math.max(...t.mfcc).toFixed(2)]})]}),U.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[U.jsx("div",{className:"text-white/60 mb-1",children:"Mean Energy"}),U.jsx("div",{className:"text-white font-medium",children:(t.mfcc.reduce((e,t)=>e+t,0)/t.mfcc.length).toFixed(3)})]})]})]})]})]})}class K{canvas;ctx;audioContext=null;analyser=null;sourceNode=null;realtimeAnimationId=null;isRunning=!1;config={fps:60,smoothing:.8,sensitivity:1,showWaveform:!0,showSpectrum:!0,showBeats:!0,colorScheme:"default",beatSensitivity:.7,spectralRange:[20,2e4]};analysisData=null;beatTracker;spectralHistory=[];maxHistoryLength=300;visualizationCallbacks=[];constructor(e,t){this.canvas=e;const s=e.getContext("2d");if(!s)throw new Error("Unable to get 2D rendering context");this.ctx=s,t&&(this.config={...this.config,...t}),this.beatTracker=new q(this.config.beatSensitivity),this.setupAudioContext()}async setupAudioContext(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=this.config.smoothing,this.analyser.minDecibels=-90,this.analyser.maxDecibels=-10}catch(e){}}async connectAudioElement(e){if(!this.audioContext||!this.analyser)throw new Error("Audio context not initialized");try{"suspended"===this.audioContext.state&&await this.audioContext.resume(),this.sourceNode&&this.sourceNode.disconnect(),this.sourceNode=this.audioContext.createMediaElementSource(e),this.sourceNode.connect(this.analyser),this.analyser.connect(this.audioContext.destination)}catch(t){throw t}}setAnalysisData(e){this.analysisData=e,e.tempo&&this.beatTracker.setTempo(e.tempo.bpm,e.tempo.beats)}updateConfig(e){this.config={...this.config,...e},this.analyser&&(this.analyser.smoothingTimeConstant=this.config.smoothing),this.beatTracker.setSensitivity(this.config.beatSensitivity)}startVisualization(e){this.isRunning||this.connectAudioElement(e).then(()=>{this.isRunning=!0,this.animate()}).catch(e=>{})}stopVisualization(){this.isRunning=!1,this.realtimeAnimationId&&(cancelAnimationFrame(this.realtimeAnimationId),this.realtimeAnimationId=null)}animate(){if(!this.isRunning||!this.analyser)return;const e=H.startTiming("realtime.visualization.frame",V.VISUALIZATION,{fps:this.config.fps});try{const e=this.analyser.frequencyBinCount,t=new Float32Array(e),s=new Uint8Array(e);this.analyser.getFloatTimeDomainData(t),this.analyser.getByteFrequencyData(s);const i=new Float32Array(s.length);for(let o=0;o<s.length;o++)i[o]=s[o]/255;this.spectralHistory.push(new Float32Array(i)),this.spectralHistory.length>this.maxHistoryLength&&this.spectralHistory.shift();const a=this.calculateRMS(t),r=Math.max(...Array.from(t).map(Math.abs)),n=this.beatTracker.detectBeat(i,a),l={waveform:t,spectrum:i,currentTime:this.audioContext?.currentTime||0,beatDetected:n,rms:a,peak:r,currentBeat:this.beatTracker.getCurrentBeat(),nextBeat:this.beatTracker.getNextBeat()};this.renderRealtimeVisualization(l),this.visualizationCallbacks.forEach(e=>{try{e(l)}catch(t){}})}catch(t){}finally{H.endTiming(e)}this.realtimeAnimationId=requestAnimationFrame(()=>this.animate())}renderRealtimeVisualization(e){this.clearCanvas();const{width:t,height:s}=this.getCanvasSize(),i=this.getContext();if(e.beatDetected){const e=.1;i.fillStyle=`rgba(59, 130, 246, ${e})`,i.fillRect(0,0,t,s)}this.config.showWaveform&&this.renderWaveform(e.waveform,{width:t,height:s}),this.config.showSpectrum&&this.renderSpectrum(e.spectrum,{width:t,height:s}),this.config.showBeats&&this.analysisData?.tempo?.beats&&this.renderBeatIndicators(e,{width:t,height:s}),this.renderAudioInfo(e,{width:t,height:s})}renderWaveform(e,t){const s=this.getContext(),{width:i,height:a}=t;s.strokeStyle=this.getColor("waveform"),s.lineWidth=2,s.beginPath();const r=i/e.length;let n=0;for(let l=0;l<e.length;l++){const t=(.5*e[l]+1)*a/4+.1*a;0===l?s.moveTo(n,t):s.lineTo(n,t),n+=r}s.stroke()}renderSpectrum(e,t){const s=this.getContext(),{width:i,height:a}=t,r=.4*a,n=.5*a,l=i/e.length,o=s.createLinearGradient(0,r,0,r+n);o.addColorStop(0,this.getColor("spectrum-high")),o.addColorStop(.5,this.getColor("spectrum-mid")),o.addColorStop(1,this.getColor("spectrum-low")),s.fillStyle=o;for(let c=0;c<e.length;c++){const t=e[c]*n,i=c*l,a=r+n-t;s.fillRect(i,a,l-1,t)}}renderBeatIndicators(e,t){const s=this.getContext(),{width:i,height:a}=t;if(e.beatDetected){const e=i-60,t=60,a=20;s.fillStyle=this.getColor("beat-active"),s.beginPath(),s.arc(e,t,a,0,2*Math.PI),s.fill(),s.strokeStyle=this.getColor("beat-pulse"),s.lineWidth=3,s.beginPath(),s.arc(e,t,a+10,0,2*Math.PI),s.stroke()}else{const e=i-60,t=60,a=15;s.strokeStyle=this.getColor("beat-inactive"),s.lineWidth=2,s.beginPath(),s.arc(e,t,a,0,2*Math.PI),s.stroke()}this.analysisData?.tempo?.beats&&this.renderBeatTimeline(e,t)}renderBeatTimeline(e,t){const s=this.getContext(),{width:i,height:a}=t,r=this.analysisData?.tempo?.beats||[],n=a-40,l=i-40;s.strokeStyle=this.getColor("timeline-bg"),s.lineWidth=2,s.beginPath(),s.moveTo(20,n),s.lineTo(20+l,n),s.stroke();const o=e.currentTime,c=l/8;s.fillStyle=this.getColor("beat-marker");for(const m of r){const e=m-o;if(e>=-2&&e<=6){const t=20+(e+2)*c,i=Math.abs(e)<.1?6:3;s.beginPath(),s.arc(t,n,i,0,2*Math.PI),s.fill()}}const d=20+2*c;s.strokeStyle=this.getColor("current-time"),s.lineWidth=2,s.beginPath(),s.moveTo(d,n-15),s.lineTo(d,n+15),s.stroke()}renderAudioInfo(e,t){const s=this.getContext(),{width:i}=t;s.font="14px -apple-system, BlinkMacSystemFont, sans-serif",s.fillStyle=this.getColor("text");const a=Math.round(100*e.rms),r=Math.round(100*e.peak);s.fillText(`RMS: ${a}%`,20,30),s.fillText(`Peak: ${r}%`,20,50),this.analysisData?.tempo?.bpm&&s.fillText(`BPM: ${this.analysisData.tempo.bpm}`,i-120,30),this.analysisData?.key?.key&&s.fillText(`Key: ${this.analysisData.key.key}`,i-120,50)}getColor(e){const t={default:{waveform:"#60A5FA","spectrum-high":"#F59E0B","spectrum-mid":"#10B981","spectrum-low":"#3B82F6","beat-active":"#10B981","beat-inactive":"#6B7280","beat-pulse":"#34D399","beat-marker":"#F59E0B","timeline-bg":"#374151","current-time":"#EF4444",text:"#F3F4F6"},neon:{waveform:"#FF00FF","spectrum-high":"#00FFFF","spectrum-mid":"#FF1493","spectrum-low":"#00FF00","beat-active":"#FF00FF","beat-inactive":"#666666","beat-pulse":"#FF69B4","beat-marker":"#00FFFF","timeline-bg":"#333333","current-time":"#FF0000",text:"#FFFFFF"},warm:{waveform:"#FF6B35","spectrum-high":"#F7931E","spectrum-mid":"#FFD23F","spectrum-low":"#FCAB10","beat-active":"#FF6B35","beat-inactive":"#8B4513","beat-pulse":"#FF8C42","beat-marker":"#F7931E","timeline-bg":"#8B4513","current-time":"#FF4500",text:"#FFF8DC"},cool:{waveform:"#00CED1","spectrum-high":"#1E90FF","spectrum-mid":"#4169E1","spectrum-low":"#0000FF","beat-active":"#00CED1","beat-inactive":"#696969","beat-pulse":"#87CEEB","beat-marker":"#1E90FF","timeline-bg":"#2F4F4F","current-time":"#FF1493",text:"#F0F8FF"}};return t[this.config.colorScheme]?.[e]||t.default[e]||"#FFFFFF"}calculateRMS(e){let t=0;for(let s=0;s<e.length;s++)t+=e[s]*e[s];return Math.sqrt(t/e.length)}getCanvasSize(){return{width:this.canvas.width,height:this.canvas.height}}getContext(){return this.ctx}clearCanvas(){const{width:e,height:t}=this.getCanvasSize();this.ctx.clearRect(0,0,e,t)}onVisualizationData(e){return this.visualizationCallbacks.push(e),()=>{const t=this.visualizationCallbacks.indexOf(e);t>-1&&this.visualizationCallbacks.splice(t,1)}}getSpectralHistory(){return[...this.spectralHistory]}getCurrentAudioData(){if(!this.analyser||!this.isRunning)return null;const e=this.analyser.frequencyBinCount,t=new Float32Array(e),s=new Uint8Array(e);this.analyser.getFloatTimeDomainData(t),this.analyser.getByteFrequencyData(s);const i=new Float32Array(s.length);for(let a=0;a<s.length;a++)i[a]=s[a]/255;return{waveform:t,spectrum:i,currentTime:this.audioContext?.currentTime||0,beatDetected:!1,rms:this.calculateRMS(t),peak:Math.max(...Array.from(t).map(Math.abs))}}destroy(){this.stopVisualization(),this.sourceNode&&this.sourceNode.disconnect(),this.audioContext&&this.audioContext.close(),this.visualizationCallbacks=[],this.spectralHistory=[]}}class q{sensitivity;tempo=120;beats=[];lastBeatTime=0;energyHistory=[];beatThreshold=.3;constructor(e=.7){this.sensitivity=e}setTempo(e,t){this.tempo=e,t&&(this.beats=[...t])}setSensitivity(e){this.sensitivity=e,this.beatThreshold=.1+.4*(1-e)}detectBeat(e,t){const s=this.calculateSpectralEnergy(e);if(this.energyHistory.push(s),this.energyHistory.length>43&&this.energyHistory.shift(),this.energyHistory.length<10)return!1;const i=this.energyHistory.reduce((e,t)=>e+t,0)/this.energyHistory.length,a=this.energyHistory.reduce((e,t)=>e+Math.pow(t-i,2),0)/this.energyHistory.length,r=i+this.sensitivity*Math.sqrt(a),n=performance.now(),l=n-this.lastBeatTime,o=60/this.tempo*1e3*.5;return s>r&&l>o&&(this.lastBeatTime=n,!0)}calculateSpectralEnergy(e){const t=Math.floor(.1*e.length);let s=0;for(let i=0;i<t;i++)s+=e[i]*e[i];return s/t}getCurrentBeat(){const e=performance.now()/1e3;let t,s=1/0;for(let i=0;i<this.beats.length;i++){const a=Math.abs(this.beats[i]-e);a<s&&(s=a,t=i)}return t}getNextBeat(){const e=performance.now()/1e3;for(const t of this.beats)if(t>e)return t}}function G({audioFile:t,isAnalyzing:s,analysisData:i,onPlaybackProgress:a,onPlaybackStateChange:r,enableRealtimeVisualization:n=!0}){const l=e.useRef(null),o=e.useRef(null),c=e.useRef(null),d=e.useRef(null),[m,j]=e.useState(!1),[N,k]=e.useState(null),[C,S]=e.useState({isPlaying:!1,currentTime:0,duration:0,volume:.8,isMuted:!1,isRepeat:!1,isShuffle:!1});e.useEffect(()=>{if(n&&c.current&&!d.current)try{d.current=new K(c.current,{fps:60,showWaveform:!0,showSpectrum:!0,showBeats:!0,colorScheme:"default"});const e=d.current.onVisualizationData(e=>{k(e)});return()=>{e(),d.current&&(d.current.destroy(),d.current=null)}}catch(e){}},[n]),e.useEffect(()=>{d.current&&i&&d.current.setAnalysisData(i)},[i]),e.useEffect(()=>{if(!t||!l.current)return;const e=l.current,s=URL.createObjectURL(t);e.src=s,e.volume=C.volume;const i=()=>{S(t=>({...t,duration:e.duration}))},n=()=>{m||(S(t=>({...t,currentTime:e.currentTime})),a?.(e.currentTime,e.duration))},o=()=>{C.isRepeat?(e.currentTime=0,e.play()):(S(e=>({...e,isPlaying:!1,currentTime:0})),r?.(!1))},c=e=>{S(e=>({...e,isPlaying:!1})),r?.(!1)};return e.addEventListener("loadedmetadata",i),e.addEventListener("timeupdate",n),e.addEventListener("ended",o),e.addEventListener("error",c),()=>{URL.revokeObjectURL(s),e.removeEventListener("loadedmetadata",i),e.removeEventListener("timeupdate",n),e.removeEventListener("ended",o),e.removeEventListener("error",c)}},[t,C.isRepeat,C.volume,m,a,r]);const F=e.useCallback(async()=>{if(!l.current||s)return;const e=l.current;try{C.isPlaying?(e.pause(),S(e=>({...e,isPlaying:!1})),r?.(!1),d.current&&d.current.stopVisualization()):(await e.play(),S(e=>({...e,isPlaying:!0})),r?.(!0),d.current&&n&&d.current.startVisualization(e))}catch(t){S(e=>({...e,isPlaying:!1})),r?.(!1),d.current&&d.current.stopVisualization()}},[C.isPlaying,s,r,n]),M=e.useCallback(()=>{if(!l.current)return;const e=l.current;e.pause(),e.currentTime=0,S(e=>({...e,isPlaying:!1,currentTime:0})),r?.(!1),d.current&&d.current.stopVisualization()},[r]),T=e.useCallback(e=>{if(!l.current)return;const t=l.current;t.currentTime=Math.max(0,Math.min(e,C.duration)),S(e=>({...e,currentTime:t.currentTime}))},[C.duration]),A=e.useCallback(()=>{T(C.currentTime-10)},[T,C.currentTime]),$=e.useCallback(()=>{T(C.currentTime+10)},[T,C.currentTime]),R=e.useCallback(()=>{if(!l.current)return;const e=l.current,t=!C.isMuted;e.muted=t,S(e=>({...e,isMuted:t}))},[C.isMuted]),D=e.useCallback(e=>{if(!l.current)return;const t=l.current,s=Math.max(0,Math.min(1,e));t.volume=s,t.muted=!1,S(e=>({...e,volume:s,isMuted:!1}))},[]),E=e.useCallback(()=>{S(e=>({...e,isRepeat:!e.isRepeat}))},[]),z=e.useCallback(()=>{S(e=>({...e,isShuffle:!e.isShuffle}))},[]),P=e.useCallback(e=>{if(!o.current||0===C.duration)return;const t=o.current.getBoundingClientRect(),s=(e.clientX-t.left)/t.width*C.duration;T(s)},[T,C.duration]),B=e.useCallback(e=>{if(!o.current||0===C.duration)return;j(!0);const t=e=>{if(!o.current)return;const t=o.current.getBoundingClientRect(),s=Math.max(0,Math.min(e.clientX-t.left,t.width))/t.width*C.duration;S(e=>({...e,currentTime:s}))},s=()=>{j(!1),l.current&&(l.current.currentTime=C.currentTime),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",s)},[C.duration,C.currentTime]),I=e=>{if(isNaN(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},L=C.duration>0?C.currentTime/C.duration*100:0,O=!t||s;return U.jsxs("div",{className:"glassmorphic-card p-6 space-y-4",children:[U.jsx("audio",{ref:l,preload:"metadata"}),U.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[U.jsx("button",{onClick:z,disabled:O,className:`glassmorphic-button p-2 transition-colors ${C.isShuffle?"text-blue-400":"text-white/60"} ${O?"opacity-50 cursor-not-allowed":"hover:text-white"}`,title:"Shuffle",children:U.jsx(u,{className:"w-5 h-5"})}),U.jsx("button",{onClick:A,disabled:O,className:"glassmorphic-button p-3 transition-colors "+(O?"opacity-50 cursor-not-allowed":"hover:text-white hover:bg-white/10"),title:"Skip backward 10s",children:U.jsx(x,{className:"w-6 h-6"})}),U.jsx("button",{onClick:F,disabled:O,className:"glassmorphic-button p-4 transition-all "+(O?"opacity-50 cursor-not-allowed":"hover:scale-105 hover:bg-blue-500/20"),title:C.isPlaying?"Pause":"Play",children:C.isPlaying?U.jsx(p,{className:"w-8 h-8 text-blue-400"}):U.jsx(g,{className:"w-8 h-8 text-blue-400"})}),U.jsx("button",{onClick:M,disabled:O,className:"glassmorphic-button p-3 transition-colors "+(O?"opacity-50 cursor-not-allowed":"hover:text-white hover:bg-white/10"),title:"Stop",children:U.jsx(f,{className:"w-6 h-6"})}),U.jsx("button",{onClick:$,disabled:O,className:"glassmorphic-button p-3 transition-colors "+(O?"opacity-50 cursor-not-allowed":"hover:text-white hover:bg-white/10"),title:"Skip forward 10s",children:U.jsx(y,{className:"w-6 h-6"})}),U.jsx("button",{onClick:E,disabled:O,className:`glassmorphic-button p-2 transition-colors ${C.isRepeat?"text-blue-400":"text-white/60"} ${O?"opacity-50 cursor-not-allowed":"hover:text-white"}`,title:"Repeat",children:U.jsx(b,{className:"w-5 h-5"})})]}),U.jsxs("div",{className:"space-y-2",children:[U.jsxs("div",{ref:o,className:"relative h-2 bg-white/10 rounded-full cursor-pointer group",onClick:P,onMouseDown:B,children:[U.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 to-blue-400 rounded-full transition-all",style:{width:`${L}%`}}),U.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-400 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity cursor-grab active:cursor-grabbing",style:{left:`calc(${L}% - 8px)`}})]}),U.jsxs("div",{className:"flex justify-between items-center text-sm text-white/60",children:[U.jsx("span",{children:I(C.currentTime)}),U.jsx("span",{children:I(C.duration)})]})]}),U.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[U.jsx("button",{onClick:R,disabled:O,className:"glassmorphic-button p-2 transition-colors "+(O?"opacity-50 cursor-not-allowed":"hover:text-white"),title:C.isMuted?"Unmute":"Mute",children:C.isMuted||0===C.volume?U.jsx(w,{className:"w-5 h-5"}):U.jsx(v,{className:"w-5 h-5"})}),U.jsx("div",{className:"flex-1 max-w-32",children:U.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:C.isMuted?0:C.volume,onChange:e=>D(parseFloat(e.target.value)),disabled:O,className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer slider "+(O?"opacity-50 cursor-not-allowed":""),style:{background:`linear-gradient(to right, #3B82F6 0%, #3B82F6 ${100*(C.isMuted?0:C.volume)}%, rgba(255,255,255,0.1) ${100*(C.isMuted?0:C.volume)}%, rgba(255,255,255,0.1) 100%)`}})}),U.jsxs("span",{className:"text-xs text-white/60 min-w-[3rem] text-right",children:[Math.round(100*(C.isMuted?0:C.volume)),"%"]})]}),n&&U.jsxs("div",{className:"border-t border-white/10 pt-4",children:[U.jsxs("div",{className:"flex items-center justify-between mb-2",children:[U.jsx("span",{className:"text-sm text-white/70",children:"Real-time Analysis"}),U.jsxs("div",{className:"flex items-center space-x-2",children:[U.jsx(h,{className:"w-4 h-4 "+(C.isPlaying?"text-green-400 animate-pulse":"text-white/40")}),N&&U.jsxs("div",{className:"flex items-center space-x-3 text-xs text-white/60",children:[U.jsxs("span",{children:["RMS: ",Math.round(100*N.rms),"%"]}),U.jsxs("span",{children:["Peak: ",Math.round(100*N.peak),"%"]}),N.beatDetected&&U.jsx("span",{className:"text-green-400 font-medium",children:"‚ô™ Beat"})]})]})]}),U.jsx("canvas",{ref:c,className:"w-full h-32 bg-black/20 rounded-lg border border-white/10",style:{imageRendering:"pixelated"}})]}),t&&U.jsxs("div",{className:"text-center text-sm text-white/60 border-t border-white/10 pt-4",children:[U.jsx("div",{className:"font-medium text-white/80 truncate",children:t.name}),U.jsxs("div",{className:"text-xs",children:[(t.size/1024/1024).toFixed(1)," MB ‚Ä¢ ",t.type||"Unknown format"]})]})]})}function Y({analysisData:t,audioFile:s,isAnalyzing:i}){const[a,r]=e.useState(new Set),[l,o]=e.useState("json"),[d,m]=e.useState(!1),[h,u]=e.useState(!1),x=[{type:"analysis-data",format:"json",name:"Analysis Data (JSON)",description:"Complete analysis results in JSON format",icon:U.jsx(j,{className:"w-4 h-4"}),size:t?`${Math.round(JSON.stringify(t).length/1024)}KB`:"N/A"},{type:"analysis-data",format:"csv",name:"Analysis Data (CSV)",description:"Structured data in CSV format for spreadsheets",icon:U.jsx(N,{className:"w-4 h-4"}),size:"varies"},{type:"summary-report",format:"txt",name:"Summary Report",description:"Human-readable analysis summary",icon:U.jsx(N,{className:"w-4 h-4"}),size:"~5KB"},{type:"detailed-report",format:"pdf",name:"Detailed Report (PDF)",description:"Professional analysis report with visualizations",icon:U.jsx(N,{className:"w-4 h-4"}),size:"~500KB"},{type:"visualization",format:"png",name:"Visualizations (PNG)",description:"All analysis charts as high-quality images",icon:U.jsx(k,{className:"w-4 h-4"}),size:"~2MB"},{type:"visualization",format:"svg",name:"Visualizations (SVG)",description:"Vector graphics for publications",icon:U.jsx(k,{className:"w-4 h-4"}),size:"~200KB"}],p=e.useCallback(()=>t?JSON.stringify({metadata:{filename:s?.name||"unknown",exportDate:(new Date).toISOString(),version:"1.0.0"},analysis:t},null,2):null,[t,s]),g=e.useCallback(()=>{if(!t)return null;const e=[];return e.push("Feature,Value,Confidence,Description"),t.tempo&&e.push(`Tempo,${t.tempo.bpm},${t.tempo.confidence||"N/A"},Beats per minute`),t.key&&(e.push(`Musical Key,${t.key.key||"Unknown"},${t.key.confidence||"N/A"},Detected musical key`),e.push(`Musical Scale,${t.key.scale||"Unknown"},,Detected musical scale`)),t.spectral&&Object.entries(t.spectral).forEach(([t,s])=>{s&&"object"==typeof s&&"mean"in s&&e.push(`Spectral ${t.charAt(0).toUpperCase()+t.slice(1)},${s.mean},,Spectral feature analysis`)}),t.duration&&e.push(`Duration,${t.duration},,Track duration in seconds`),e.join("\n")},[t]),f=e.useCallback(()=>{if(!t)return null;const e=[];if(e.push("HARMONIX PRO ANALYZER - ANALYSIS SUMMARY"),e.push("=".repeat(50)),e.push(""),s&&(e.push(`File: ${s.name}`),e.push(`Size: ${(s.size/1024/1024).toFixed(2)} MB`),e.push(`Type: ${s.type||"Unknown"}`),e.push("")),e.push("ANALYSIS RESULTS"),e.push("-".repeat(20)),t.tempo&&(e.push(`Tempo: ${t.tempo.bpm} BPM`),e.push(`Tempo Confidence: ${(100*(t.tempo.confidence||0)).toFixed(1)}%`),e.push("")),t.key&&(e.push(`Musical Key: ${t.key.key||"Unknown"}`),e.push(`Musical Scale: ${t.key.scale||"Unknown"}`),e.push(`Key Confidence: ${(100*(t.key.confidence||0)).toFixed(1)}%`),e.push("")),t.spectral&&(e.push("SPECTRAL FEATURES"),e.push("-".repeat(20)),Object.entries(t.spectral).forEach(([t,s])=>{s&&"object"==typeof s&&"mean"in s&&e.push(`${t.charAt(0).toUpperCase()+t.slice(1)}: ${s.mean?.toFixed(2)||"N/A"}`)}),e.push("")),t.duration){const s=Math.floor(t.duration/60),i=Math.floor(t.duration%60);e.push(`Duration: ${s}:${i.toString().padStart(2,"0")}`),e.push("")}return e.push(`Generated: ${(new Date).toLocaleString()}`),e.push("Harmonix Pro Analyzer v1.0.0"),e.join("\n")},[t,s]),y=e.useCallback((e,t,s)=>{const i=new Blob([e],{type:s}),a=URL.createObjectURL(i),r=document.createElement("a");r.href=a,r.download=t,r.click(),URL.revokeObjectURL(a)},[]),b=e.useCallback(async e=>{if(t&&!d){m(!0);try{const t=s?.name.replace(/\.[^/.]+$/,"")||"harmonix-analysis";switch(e.type){case"analysis-data":if("json"===e.format){const e=p();e&&y(e,`${t}-analysis.json`,"application/json")}else if("csv"===e.format){const e=g();e&&y(e,`${t}-analysis.csv`,"text/csv")}break;case"summary-report":{const e=f();e&&y(e,`${t}-summary.txt`,"text/plain");break}}}catch(i){}finally{m(!1)}}},[t,s,d,p,g,f,y]),w=e.useCallback(async e=>{try{await navigator.clipboard.writeText(e)}catch(t){}},[]),v=e.useCallback(async()=>{if(!t||!s)return;const e={title:`Music Analysis: ${s.name}`,text:f()||"Music analysis results from Harmonix Pro Analyzer",url:window.location.href};if(navigator.share)try{await navigator.share(e)}catch(i){}else await w(window.location.href)},[t,s,f,w]),M=!t||i;return U.jsxs("div",{className:"space-y-4",children:[U.jsxs("div",{className:"glassmorphic-card p-4",children:[U.jsxs("div",{className:"flex items-center justify-between mb-4",children:[U.jsx("h3",{className:"text-lg font-semibold text-white",children:"Export Analysis"}),U.jsxs("div",{className:"flex space-x-2",children:[U.jsx("button",{onClick:v,disabled:M,className:"glassmorphic-button p-2 transition-colors "+(M?"opacity-50 cursor-not-allowed":"hover:bg-blue-500/20"),title:"Share analysis",children:U.jsx(C,{className:"w-4 h-4"})}),U.jsx("button",{onClick:()=>u(!h),className:"glassmorphic-button p-2 hover:bg-white/10 transition-colors",title:"Advanced options",children:U.jsx(S,{className:"w-4 h-4"})})]})]}),U.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:x.slice(0,3).map(e=>U.jsx("button",{onClick:()=>b(e),disabled:M||d,className:`\n                glassmorphic-button p-4 text-left transition-all\n                ${M||d?"opacity-50 cursor-not-allowed":"hover:bg-white/10 hover:scale-105"}\n              `,children:U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"text-blue-400",children:e.icon}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("div",{className:"font-medium text-white text-sm truncate",children:e.name}),U.jsx("div",{className:"text-white/60 text-xs",children:e.size})]}),U.jsx(c,{className:"w-4 h-4 text-white/60"})]})},`${e.type}-${e.format}`))})]}),h&&U.jsxs("div",{className:"glassmorphic-card p-4",children:[U.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Advanced Export Options"}),U.jsx("div",{className:"space-y-3",children:x.map(e=>U.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-white/10 hover:bg-white/5 transition-colors",children:[U.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[U.jsx("div",{className:"text-blue-400",children:e.icon}),U.jsxs("div",{className:"flex-1",children:[U.jsx("div",{className:"font-medium text-white text-sm",children:e.name}),U.jsx("div",{className:"text-white/60 text-xs",children:e.description})]}),U.jsx("div",{className:"text-white/60 text-xs",children:e.size})]}),U.jsxs("div",{className:"flex items-center space-x-2",children:["analysis-data"===e.type&&U.jsx("button",{onClick:()=>{const t="json"===e.format?p():g();t&&w(t)},disabled:M,className:"glassmorphic-button p-2 "+(M?"opacity-50 cursor-not-allowed":"hover:bg-blue-500/20"),title:"Copy to clipboard",children:U.jsx(F,{className:"w-3 h-3"})}),U.jsx("button",{onClick:()=>b(e),disabled:M||d,className:"glassmorphic-button p-2 "+(M||d?"opacity-50 cursor-not-allowed":"hover:bg-green-500/20"),title:"Download",children:U.jsx(c,{className:"w-3 h-3"})})]})]},`${e.type}-${e.format}`))})]}),d&&U.jsx("div",{className:"glassmorphic-card p-4",children:U.jsxs("div",{className:"flex items-center space-x-3",children:[U.jsx("div",{className:"w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),U.jsx("span",{className:"text-white/80",children:"Preparing export..."})]})}),!t&&!i&&U.jsxs("div",{className:"glassmorphic-card p-8 text-center",children:[U.jsx(n,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),U.jsx("h3",{className:"text-lg font-semibold text-white/80 mb-2",children:"No Analysis Data"}),U.jsx("p",{className:"text-white/60",children:"Upload and analyze an audio file to enable export functionality."})]})]})}const J=e.createContext(null);function Z(){const t=e.useContext(J);if(!t)throw new Error("useNotifications must be used within a NotificationProvider");return t}function X({children:t,maxNotifications:s=5}){const[i,a]=e.useState([]),r=e.useCallback(e=>{const t=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,i={...e,id:t,duration:e.duration??("error"===e.type?8e3:5e3)};return a(e=>[i,...e].slice(0,s)),!e.persistent&&i.duration&&i.duration>0&&setTimeout(()=>{a(e=>e.filter(e=>e.id!==t))},i.duration),t},[s]),n=e.useCallback(e=>{a(t=>t.filter(t=>t.id!==e))},[]),l=e.useCallback(()=>{a([])},[]);return U.jsxs(J.Provider,{value:{notifications:i,addNotification:r,removeNotification:n,clearAll:l},children:[t,U.jsx(Q,{})]})}function Q(){const{notifications:e}=Z();return 0===e.length?null:U.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-3 max-w-sm w-full",children:e.map(e=>U.jsx(ee,{notification:e},e.id))})}function ee({notification:i}){const{removeNotification:a}=Z(),[n,l]=e.useState(!1),[o,c]=e.useState(!1);e.useEffect(()=>{const e=setTimeout(()=>l(!0),10);return()=>clearTimeout(e)},[]);const d=e.useCallback(()=>{c(!0),setTimeout(()=>{a(i.id)},300)},[i.id,a]),m=(()=>{switch(i.type){case"success":return{bg:"bg-green-500/10 border-green-500/30",text:"text-green-400",title:"text-green-300"};case"error":return{bg:"bg-red-500/10 border-red-500/30",text:"text-red-400",title:"text-red-300"};case"warning":return{bg:"bg-yellow-500/10 border-yellow-500/30",text:"text-yellow-400",title:"text-yellow-300"};case"info":return{bg:"bg-blue-500/10 border-blue-500/30",text:"text-blue-400",title:"text-blue-300"};default:return{bg:"bg-gray-500/10 border-gray-500/30",text:"text-gray-400",title:"text-gray-300"}}})();return U.jsxs("div",{className:`\n        glassmorphic-card border-2 p-4 shadow-lg transition-all duration-300 ease-out\n        ${m.bg}\n        ${n&&!o?"translate-x-0 opacity-100":"translate-x-full opacity-0"}\n        ${o?"scale-95":"scale-100"}\n      `,children:[U.jsxs("div",{className:"flex items-start space-x-3",children:[U.jsx("div",{className:`flex-shrink-0 ${m.text}`,children:(()=>{switch(i.type){case"success":return U.jsx(t,{className:"w-5 h-5"});case"error":return U.jsx(s,{className:"w-5 h-5"});case"warning":return U.jsx(T,{className:"w-5 h-5"});default:return U.jsx(M,{className:"w-5 h-5"})}})()}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("h4",{className:`font-semibold text-sm ${m.title}`,children:i.title}),i.message&&U.jsx("p",{className:"text-white/70 text-sm mt-1 leading-relaxed",children:i.message}),i.action&&U.jsx("button",{onClick:i.action.onClick,className:`\n                mt-2 text-xs font-medium px-3 py-1 rounded-md transition-colors\n                ${m.text} hover:bg-white/10\n              `,children:i.action.label})]}),U.jsx("button",{onClick:d,className:"flex-shrink-0 text-white/60 hover:text-white/80 transition-colors p-1 rounded-md hover:bg-white/10","aria-label":"Dismiss notification",children:U.jsx(r,{className:"w-4 h-4"})})]}),i.duration&&i.duration>0&&!i.persistent&&U.jsx("div",{className:"mt-3 h-1 bg-white/10 rounded-full overflow-hidden",children:U.jsx("div",{className:`h-full ${m.text.replace("text-","bg-")} transition-all ease-linear`,style:{animation:`notification-progress ${i.duration}ms linear forwards`}})})]})}function te(){const{addNotification:t}=Z();return{success:e.useCallback((e,s,i)=>t({...i,type:"success",title:e,message:s}),[t]),error:e.useCallback((e,s,i)=>t({...i,type:"error",title:e,message:s,duration:8e3}),[t]),warning:e.useCallback((e,s,i)=>t({...i,type:"warning",title:e,message:s}),[t]),info:e.useCallback((e,s,i)=>t({...i,type:"info",title:e,message:s}),[t]),analysisComplete:e.useCallback(e=>t({type:"success",title:"Analysis Complete",message:`Successfully analyzed ${e}`,duration:5e3}),[t]),analysisError:e.useCallback((e,s)=>t({type:"error",title:"Analysis Failed",message:`Failed to analyze ${e}: ${s}`,duration:1e4,action:{label:"Try Again",onClick:()=>window.location.reload()}}),[t]),fileUploaded:e.useCallback(e=>t({type:"info",title:"File Uploaded",message:`${e} is ready for analysis`,duration:3e3}),[t]),engineReady:e.useCallback(()=>t({type:"success",title:"Engine Ready",message:"Audio analysis engine is now ready for use",duration:4e3}),[t]),engineError:e.useCallback(e=>t({type:"error",title:"Engine Error",message:`Analysis engine error: ${e}`,persistent:!0,action:{label:"Reload",onClick:()=>window.location.reload()}}),[t])}}function se({steps:e,currentStep:i,orientation:a="vertical",showProgress:r=!0,showTimers:n=!1}){const l=e=>{switch(e.status){case"completed":return U.jsx(t,{className:"w-5 h-5 text-green-400"});case"error":return U.jsx(s,{className:"w-5 h-5 text-red-400"});case"active":return U.jsx($,{className:"w-5 h-5 text-blue-400 animate-spin"});default:return U.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-white/30"})}},o=e=>{switch(e.status){case"completed":return"text-green-400 border-green-400/50";case"error":return"text-red-400 border-red-400/50";case"active":return"text-blue-400 border-blue-400/50";default:return"text-white/60 border-white/30"}},c=e=>{if(e<60)return`${Math.round(e)}s`;return`${Math.floor(e/60)}m ${Math.round(e%60)}s`};return"horizontal"===a?U.jsx("div",{className:"glassmorphic-card p-6",children:U.jsx("div",{className:"flex items-center justify-between",children:e.map((t,s)=>U.jsxs("div",{className:"flex items-center flex-1",children:[U.jsxs("div",{className:`flex flex-col items-center text-center ${o(t)}`,children:[U.jsx("div",{className:"mb-2",children:l(t)}),U.jsx("div",{className:"text-sm font-medium",children:t.label}),t.description&&U.jsx("div",{className:"text-xs text-white/60 mt-1",children:t.description}),r&&void 0!==t.progress&&"active"===t.status&&U.jsxs("div",{className:"mt-2 text-xs text-blue-400",children:[Math.round(t.progress),"%"]})]}),s<e.length-1&&U.jsx("div",{className:"flex-1 h-px bg-white/20 mx-4"})]},t.id))})}):U.jsx("div",{className:"glassmorphic-card p-6",children:U.jsx("div",{className:"space-y-4",children:e.map((t,s)=>U.jsxs("div",{className:"flex items-start space-x-4",children:[U.jsxs("div",{className:"flex flex-col items-center",children:[l(t),s<e.length-1&&U.jsx("div",{className:"w-px h-8 bg-white/20 mt-2"})]}),U.jsxs("div",{className:"flex-1 min-w-0",children:[U.jsx("div",{className:`font-medium ${o(t)}`,children:t.label}),t.description&&U.jsx("div",{className:"text-white/60 text-sm mt-1",children:t.description}),r&&void 0!==t.progress&&"active"===t.status&&U.jsxs("div",{className:"mt-2",children:[U.jsxs("div",{className:"flex justify-between items-center text-xs text-white/60 mb-1",children:[U.jsx("span",{children:"Progress"}),U.jsxs("span",{children:[Math.round(t.progress),"%"]})]}),U.jsx("div",{className:"w-full h-2 bg-white/10 rounded-full overflow-hidden",children:U.jsx("div",{className:"h-full bg-blue-400 transition-all duration-300 ease-out",style:{width:`${t.progress}%`}})})]}),n&&(t.timeElapsed||t.timeRemaining)&&U.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-xs text-white/60",children:[t.timeElapsed&&U.jsxs("div",{className:"flex items-center space-x-1",children:[U.jsx(A,{className:"w-3 h-3"}),U.jsxs("span",{children:["Elapsed: ",c(t.timeElapsed)]})]}),t.timeRemaining&&U.jsxs("div",{className:"flex items-center space-x-1",children:[U.jsx(A,{className:"w-3 h-3"}),U.jsxs("span",{children:["Remaining: ",c(t.timeRemaining)]})]})]})]})]},t.id))})})}function ie({progress:e,size:t=120,strokeWidth:s=8,showPercentage:i=!0,color:a="#3B82F6",backgroundColor:r="rgba(255, 255, 255, 0.1)",children:n}){const l=(t-s)/2,o=2*l*Math.PI,c=o-e/100*o;return U.jsxs("div",{className:"relative",style:{width:t,height:t},children:[U.jsxs("svg",{width:t,height:t,className:"transform -rotate-90",children:[U.jsx("circle",{cx:t/2,cy:t/2,r:l,stroke:r,strokeWidth:s,fill:"transparent"}),U.jsx("circle",{cx:t/2,cy:t/2,r:l,stroke:a,strokeWidth:s,fill:"transparent",strokeDasharray:o,strokeDashoffset:c,strokeLinecap:"round",className:"transition-all duration-500 ease-out"})]}),U.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n||i&&U.jsx("div",{className:"text-center",children:U.jsxs("div",{className:"text-2xl font-bold text-white",children:[Math.round(e),"%"]})})})]})}function ae({status:e,text:i,showIcon:a=!0,size:r="md"}){const l=(()=>{switch(e){case"loading":return{bg:"bg-blue-500/10 border-blue-500/30",text:"text-blue-400",icon:U.jsx($,{className:"animate-spin"}),defaultText:"Loading..."};case"success":return{bg:"bg-green-500/10 border-green-500/30",text:"text-green-400",icon:U.jsx(t,{}),defaultText:"Success"};case"error":return{bg:"bg-red-500/10 border-red-500/30",text:"text-red-400",icon:U.jsx(s,{}),defaultText:"Error"};case"warning":return{bg:"bg-yellow-500/10 border-yellow-500/30",text:"text-yellow-400",icon:U.jsx(s,{}),defaultText:"Warning"};default:return{bg:"bg-gray-500/10 border-gray-500/30",text:"text-gray-400",icon:U.jsx(n,{}),defaultText:"Idle"}}})();return U.jsxs("div",{className:`\n      inline-flex items-center space-x-2 border rounded-full font-medium\n      ${l.bg} ${l.text} ${{sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"}[r]}\n    `,children:[a&&U.jsx("div",{className:{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[r],children:l.icon}),U.jsx("span",{children:i||l.defaultText})]})}export{_ as A,ie as C,Y as E,W as F,X as N,H as P,ae as S,G as T,V as a,se as b,U as j,te as u};
//# sourceMappingURL=components-DJtJ1Bhn.js.map
